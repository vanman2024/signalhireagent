# Repository Guidelines

## Project Structure & Module Organization
- `src/`: application code (cli, lib, models, services, signalhire_agent).
- `tests/`: test suites (contract, helpers, integration, performance, unit).
- `scripts/`: helper scripts (e.g., `git-commit-helper.sh`, `create-new-feature.sh`).
- `templates/`, `specs/`, `memory/`: support assets and specifications.
- Configuration: `.env` for local secrets, `pyproject.toml` for tooling.
## Build, Test, and Development Commands
- Setup dev env: `pip install -e .[dev]`.
- Lint: `ruff check .` (fix: `ruff check --fix .`)
- Format: `black .`.
- Type-check: `mypy src`.
- Tests (all): `python3 run.py -m pytest`.
- Tests with coverage: `python3 run.py -m pytest --cov=src --cov-report=term-missing`.
- Test selection: `python3 run.py -m pytest -m unit`, `python3 run.py -m pytest -m "integration and not slow"`.
## Coding Style & Naming Conventions
- Python 3.11+. Use 4-space indentation, line length 88.
- Naming: `snake_case` for modules/functions, `PascalCase` for classes, `UPPER_CASE` for constants.
- Prefer async/await, typed functions, and Pydantic models for data shapes.
- Formatting: Black; Linting: Ruff (rules configured in `pyproject.toml`).
- Type safety: MyPy in strict-ish mode (see `[tool.mypy]`).
## Testing Guidelines
- Framework: `pytest` with `pytest-asyncio`; markers: contract, integration, unit, performance, browser, slow, asyncio.
- File naming: `tests/**/test_*.py`.
- Aim for ‚â•80% coverage on new/changed code; include negative and async-path tests.
- Browser/slow tests should be marked; default CI path should skip `-m slow`.
## üö® CRITICAL: Agent Commit Requirements
**MANDATORY for ALL AGENTS**: Every commit must identify the agent and reference task numbers.

### Commit Template for ALL Agents:
```bash
git commit -m "$(cat <<'EOF'
[ACTION_TYPE]: Brief description of changes

- Specific change 1
- Specific change 2
- Reference task numbers completed (T###)

[AGENT_NAME] completed: T### Task description
Supports: [Project specification reference]

ü§ñ Generated by [AGENT_NAME] with Claude Code

Co-Authored-By: [AGENT_NAME] <noreply@anthropic.com>
EOF
)"
```

### Agent-Specific Examples:

**@claude (Worker Claude):**
```bash
ü§ñ Generated by Claude with Claude Code
Co-Authored-By: Claude <noreply@anthropic.com>
Claude completed: T025 Add configuration management for API vs browser preferences
```

**@copilot (GitHub Copilot):**
```bash  
ü§ñ Generated by Copilot with Claude Code
Co-Authored-By: Copilot <noreply@anthropic.com>
Copilot completed: T010 CLI improvements for user experience
```

**@gemini (Google Gemini):**
```bash
ü§ñ Generated by Gemini with Claude Code
Co-Authored-By: Gemini <noreply@anthropic.com>
Gemini completed: T029 Update CLI command documentation
```

**@codex (OpenAI Codex):**
```bash
ü§ñ Generated by Codex with Claude Code
Co-Authored-By: Codex <noreply@anthropic.com>
Codex completed: T004 Enhanced API client contract test
```

### Task Completion Requirements:
- ‚úÖ **ALWAYS mark tasks complete** with `[x]` in tasks.md
- ‚úÖ **ALWAYS commit with agent attribution**
- ‚úÖ **ALWAYS reference specific task numbers**
- ‚úÖ **NEVER leave uncommitted work when marking tasks complete**

## Commit & Pull Request Guidelines
- Conventional Commits: `feat: ...`, `fix: ...`, `chore: ...`, `docs: ...` (see `git log`).
- Branches: `feature/<short-name>`, `fix/<short-name>`, `chore/<short-name>`.
- Use `scripts/git-commit-helper.sh` to compose consistent messages.
- PRs must include: clear description, linked issue, test coverage notes, and screenshots/logs for CLI changes.
- Ensure lint, type-check, and tests pass before requesting review.

## Security & Configuration
- Do not commit secrets. Store local creds in `.env` (e.g., `SIGNALHIRE_EMAIL`, `SIGNALHIRE_PASSWORD`).
- Validate inputs and log via `structlog`; avoid logging sensitive data.
- For browser automation and external services, isolate integration tests with markers and feature flags.

## Architecture Notes
- Layers: `cli` (entrypoints), `services` (business logic), `models` (Pydantic), `lib` (helpers).
- Keep `services` pure and I/O at the edges to ease testing.

## Task Assignment & Coordination

### My Responsibilities (@codex)
**Check current spec's tasks.md for @codex assignments:**
- Contract tests and test-driven development (write failing tests first)
- Integration tests with httpx mocking to avoid burning credits
- Unit tests for shared libraries and cost control systems
- Live E2E smoke testing with minimal resource usage
- Frontend tasks and user interface development

### Task Workflow & Completion Requirements
1. **Check for assignments**: Look for `@codex` in tasks.md
2. **Implement the task**: Follow the task description and requirements
3. **Write unit tests**: Create corresponding tests if implementation involves code
4. **COMMIT YOUR WORK**: All agents MUST commit their code changes when tasks are complete
5. **Mark completion**: Change `[ ]` to `[x]` in tasks.md immediately after finishing - this is your commitment symbol
6. **Document**: Add any necessary documentation or comments

### Critical Completion Protocol
- ‚úÖ **ALWAYS commit code changes** when completing tasks
- ‚úÖ **ALWAYS mark tasks as complete** with `[x]` symbol in tasks.md
- ‚úÖ **Use completion symbols** to show you have committed your work
- ‚ùå **NEVER leave uncommitted work** when marking tasks complete

### Current @codex Tasks
```bash
# Check my current assignments:
grep "@codex" [current-spec]/tasks.md
```

### Example Task Pattern
```
- [ ] T035 @codex Unit tests for data model validation
```
**After completion:**
```  
- [x] T035 @codex Unit tests for data model validation
```

## WSL Environment Notes
- When reading screenshots or working with Windows paths, always use WSL-compatible paths (e.g., `/mnt/c/` instead of `C:\`)
- Screenshots saved by Windows applications should be accessed via WSL path format



## CLI Commands for All AI Agents

**üìñ Complete Reference**: See `docs/cli-commands.md`

When users give natural language requests, ALL agents should reference the CLI command mappings:

### Quick Command Reference:
- **"Find prospects"** ‚Üí `signalhire search --title "X" --location "Y"`
- **"Merge contact files"** ‚Üí `signalhire dedupe merge --input "file1,file2" --output merged.json`
- **"Check daily limits"** ‚Üí `signalhire status --credits`
- **"Remove unwanted titles"** ‚Üí `signalhire filter job-title --exclude-job-titles "operator,driver"`
- **"Analyze contacts"** ‚Üí `signalhire analyze job-titles --input contacts.json`

### Key Features ALL Agents Should Know:
- ‚úÖ **Search Profile Tracking**: 5000/day automatic limit monitoring
- ‚úÖ **Contact Reveals**: 5000/day with usage warnings (50%, 75%, 90%)
- ‚úÖ **Boolean Search**: AND, OR, NOT operators supported
- ‚úÖ **Contact Deduplication**: uid-based merging with LinkedIn fallback
- ‚úÖ **Geographic Analysis**: Coverage gaps and optimization suggestions
- ‚úÖ **Progress Tracking**: Resume capability for large operations

## Active Technologies
- Python 3.11 + asyncio (signalhireagent)
- FastAPI (MCP server + autonomous workflows)
- httpx (async HTTP client for SignalHire API + test mocking)
- pytest (testing framework with contract/integration/unit tests)
- pandas (CSV data processing and export)
- pydantic (data validation and MCP tool models)
- Frontend technologies (for UI development tasks)
## Custom Instructions
- Always use absolute paths when reading files

## Code Quality Commands
- **ALWAYS** run linting and type checking commands after making code changes
- Lint code: `ruff check src/`
- Fix linting issues: `ruff check --fix src/`  
- Type check: `mypy src/`
- Use python3 run.py instead of direct pytest commands for consistent environment setup
- Test message for consistent behavior
- Never commit secrets or API keys - always use environment variables and .env files
- You're absolutely right - the environment variable issue is frustrating! The problem is that we're running Python from Windows but the .env file is in the WSL filesystem, so the environment variables aren't being loaded properly. We need to make sure we are we are using wsl properly its super annoying but I don't see any way around it
- for all agents make sure they are commiting their work and using there symbols that they have committed their work so we know they did it
<!-- MANUAL ADDITIONS END -->

<!-- MANUAL ADDITIONS START -->

## Custom Instructions
- Always validate input parameters in all functions

- Never commit secrets or API keys - always use environment variables and .env files
- You're absolutely right - the environment variable issue is frustrating! The problem is that we're running Python from Windows but the .env file is in the WSL filesystem, so the environment variables aren't being loaded properly. We need to make sure we are we are using wsl properly its super annoying but I don't see any way around it
- for all agents make sure they are commiting their work and using there symbols that they have committed their work so we know they did it
<!-- MANUAL ADDITIONS END -->
